# 暑期班拼团活动需求文档

## 1 简介
### 1.1 文档目的
　　编写此文档的目的是进一步定制软件开发的功能列表，希望能使本软件开发工作更具体。为了使用户、软件开发者及分析和测试人员对该软件的初始规定有一个共同的理解，它说明了本软件的各项功能需求，明确标识各项功能的具体含义，阐述实用背景及范围，提供客户解决问题或达到目标所需要的条件或权能，提供一个度量和遵循的基准。具体而言，编写软件需求说明的目的是为所开发的软件提出：

* 软件设计总体要求，作为软件开发人员、软件测试人员相互了解的基础
* 功能、性能要求，数据结构和采集要求，重要的接口要求，作为软件设计人员进行概要设计的依据；
* 软件确认测试的依据。

### 1.2 适用群体
本文档建议适用人员：
* 软件开发人员；
* 软件测试人员。

## 2 前端H5拼团页面

* 三人成团的拼团购买活动，单人购买XXX元、3人成团购买298元/人；开团人298元购买后需生成代表自己团的二维码海报，他人扫描二维码参加该团，3人即可成团，超过3人时需另开团。

![活动流程图](https://raw.githubusercontent.com/systemcc/group-buying/master/IMG/%E6%B4%BB%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%9B%BE.png)*活动流程图*

### 2.1 活动海报
* 活动海报，扫描二维码进入拼团购买页面（2.2页面），该二维码需携带渠道编码（如SA：01，创业CC：02，SC：03）,因此扫描该二维码的所有用户及其参加活动后分享的活动二维码均携带此渠道编码参数。

![活动海报](https://raw.githubusercontent.com/systemcc/group-buying/master/IMG/%E6%B4%BB%E5%8A%A8%E6%B5%B7%E6%8A%A5.png)*活动海报*

### 2.2 拼团活动-购买页面
* 活动海报扫描二维码后，如为新用户则先进行“微信授权”，允许授权后进入该购买页面，，已授权用户直接进入购买页面，如下图：

![拼团活动-购买页面](https://raw.githubusercontent.com/systemcc/group-buying/master/IMG/%E6%8B%BC%E5%9B%A2%E6%B4%BB%E5%8A%A8-%E8%B4%AD%E4%B9%B0%E9%A1%B5%E9%9D%A2.png)*拼团活动-购买页面*

#### 2.2.1 课程介绍+拼团规则
* 该部分内容为写死的图文介绍。

#### 2.2.2 单独购买
* 单独购买，价格为960元，按钮标记“单独购 ￥960”，点击该按钮可直接购买，</br>
1、如为已登录用户，则直接在该购买页面上弹出层微信支付页面进行支付，支付成功后点击“完成”页面返回以下页面（购买按钮变为“购买成功，分享活动”），如下图：</br>
2、如为未登录用户，则先弹出层进行登录或注册（登录注册详见2.2.4登录注册），成功登录后，弹出层微信支付页面进行支付，后续流程与1一致。
3、单独购买的用户，在点击“单独购”同时成功登录后即可生成订单（当前订单状态为“待支付”），正确输入支付密码后，订单状态变为“已支付”。

![单独购买成功页面](https://raw.githubusercontent.com/systemcc/group-buying/master/IMG/%E5%8D%95%E7%8B%AC%E8%B4%AD%E4%B9%B0-%E6%94%AF%E4%BB%98%E6%88%90%E5%8A%9F%E5%90%8E%E9%A1%B5%E9%9D%A2.png)*单独购买后支付成功页面*

#### 2.2.3 开团购买
* 拼团购买，该团第一人作为团长可开团购买，其他人为参团购买，按钮标记“开团/参团购买 ￥298”，点击该按钮开团购买，</br>
1、如为已登录用户，则直接在该购买页面上弹出层微信支付页面进行支付，支付成功后点击“完成”页面跳转至2.2.5页面；
2、如为未登录用户，则先弹出层进行登录或注册（登录注册详见2.2.4登录注册），成功登录后，弹出层微信支付页面进行支付，后续流程与1一致。
3、开团购买的用户，在点击“开团购买”同时成功登录后即可生成订单（当前订单状态为“待支付”），正确输入支付密码后，订单状态变为“已支付”。

#### 2.2.4 登录/注册页面
* 与官网登录注册基本相同，直接在当前购买页面弹出层进行登录或注册；

##### 2.2.4.1 登录
* 点击单独购或开团\参团购买后，如用户未登录，则弹出层打开登录页面（默认显示登录标签），如下图：

![账号登录](https://raw.githubusercontent.com/systemcc/group-buying/master/IMG/%E8%B4%A6%E5%8F%B7%E7%99%BB%E5%BD%95.png)*账号登陆*

|元素名称|类型|跳转关系|校验规则|报错提示|元素样式和说明|
|-------|----|-------|-------|--------|-------------|
|账号|单行输入框||必填项，11位手机号码格式|为空时提交，该输入框边框变为红色|1、用户输入手机号码作为账号登录系统；</br>2、单行输入框默认显示“请输入手机号码”，输入框获取指针则该默认显示内容隐藏。|
|密码|单行输入框||必填项，密码格式与官网的密码格式相同|为空时提交，该输入框边框变为红色|1、输入账号对应的密码，密码显示为密文“原点”；</br>2、单行输入框默认显示“请输入密码”，输入框获取指针则该默认显示内容隐藏。|
|点击登录|按钮|账号密码匹配登录成功，则关闭弹出层后打开微信支付弹出层||1、无此账号，点击登录则红色字提示“用户不存在”；</br>2、密码不正确，点击登录则红色字显示“密码不正确”。|点击登录，提交账号密码，进行验证。|

##### 2.2.4.2 注册
* 非金沃斯用户则需先进行注册，注册成功即同时登录成功，注册页面如下图：

![账号注册](https://raw.githubusercontent.com/systemcc/group-buying/master/IMG/%E8%B4%A6%E5%8F%B7%E6%B3%A8%E5%86%8C.png)*账号注册*

|元素名称|类型|跳转关系|校验规则|报错提示|元素样式和说明|
|-------|----|-------|-------|--------|-------------|
|账号|单行输入框||必填项，11位手机号码格式|为空时提交，该输入框边框变为红色|1、用户输入手机号码作为账号注册；</br>2、单行输入框默认显示“请输入手机号码”，输入框获取指针则该默认显示内容隐藏。|
|密码|单行输入框||必填项，密码格式与官网的密码格式相同|为空时提交，该输入框边框变为红色|1、输入账号对应的密码，密码显示为密文“原点”；</br>2、单行输入框默认显示“请输入密码”，输入框获取指针则该默认显示内容隐藏。|
|验证码|单行输入框+按钮||必填项，5字符|为空时提交，该输入框边框变为红色|1、手机号码为非空时，点击“获取验证码”按钮，手机收到验证码短信；</br>2、验证码输入框，填写短信收到的信息；</br>3、单行输入框默认显示“输入验证码”，输入框获取指针则该默认显示内容隐藏。|
|点击注册|按钮||账号密码验证码正确，成功注册后弹出层页面变为“完善信息”（详见2.2.4.3）|1、手机号码为已有账号，点击注册则红色字提示“用户已存在”；</br>2、密码不符合规则，则红色字提示“请填写6-16位，英文数字”；</br>3、验证码错误，红色字则提示“验证码有误”。|点击注册，提交注册信息。|

##### 2.2.4.3 注册-完善信息
* 注册成功后，需完善用户信息：姓名和学习英语年限。

![注册-完善信息](https://raw.githubusercontent.com/systemcc/group-buying/master/IMG/%E6%B3%A8%E5%86%8C-%E5%AE%8C%E5%96%84%E4%BF%A1%E6%81%AF.png)*注册-完善信息*

|元素名称|类型|跳转关系|校验规则|报错提示|元素样式和说明|
|-------|----|-------|-------|--------|-------------|
|学生姓名|单行输入框||必填项，20字符|为空时提交，该输入框边框变为红色|输入学生姓名，为订单中的姓名|
|学习英语年限|下拉框选择||非必选项||选择学习英语年限，1年-N年，与官网相同即可。|
|完善信息|按钮|完善信息正确，点击后完善后关闭该弹出层后，显示微信支付弹出层。|||提交姓名、学习年限，补充用户信息，提交成功则同时登录新注册用户成功。|

#### 2.2.5 扫码页面+订单详情
* 支付成功后页面跳转至微信支付完成页面，点击该页面的“完成”按钮，则跳转至该页面，如下图：
* 顶部为服务号二维码，二维码下方文字提示“关注“金沃斯在线英语”，拼团信息和更多精彩会及时推送！”；
* 订单详情：
  订单号、拼团名称、订单提交时间、支付金额、支付时间、订单状态。

![支付后-扫码页面](https://raw.githubusercontent.com/systemcc/group-buying/master/IMG/%E6%94%AF%E4%BB%98%E5%90%8E-%E6%89%AB%E7%A0%81%E9%A1%B5%E9%9D%A2.png)*支付后-扫码页面*

1、“开团成功，邀请好友来参团”，点击该按钮进入分享引导（灰色层，箭头引导至右上角分享，点击“右上角的分享”或其他空白处，分享引导隐藏）。</br>
2、分享内容为活动海报，海报二维码为携带根部渠道编码，以及当前分享用户的OpenID信息，他人扫描该海报二维码参团，记录相同渠道以及父节点为该用户。</br>
3、成功分享好友或朋友圈后，页面跳转至2.2.6我的拼团页面。

#### 2.2.6 我的拼团页面
* 我的拼团页面，包含活动进度和我的朋友两个标签信息，默认显示为活动进度标签。
* 无论页面怎么滑动，“邀请好友参团”的按钮始终置于底部。

##### 2.2.6.1 活动进度
* 活动进度内容包含：活动倒计时、参团人信息、参团进度以及使用说明
* 活动倒计时：当前时间距离团购活动截止日期（），的天时分秒，时间滚动着。
* 参团人信息：包含微信头像以及文字提示“邀请N名成员即可成团”，默认情况下三个头像为灰色，当开团成功后，第一个头像被点亮（同时文字提示为邀请2名成员即可成团）；当有1名成员成功参团（参团并支付成功）时，第二个头像被点亮（同时文字提示为邀请1名成员即可成团）；当有2名成员成功参团时，三个头像均被点亮（同时文字提示拼团成功）。
* 参团进度：开团当团长-邀请中-拼团成功，默认为灰色，当开团成功后开团人查看到页面时，开团当团长+邀请中被点亮，直到3人成团后，第三个进度被点亮。
* 使用说明：图文信息。

![我的拼团页面-活动进度](https://raw.githubusercontent.com/systemcc/group-buying/master/IMG/%E6%88%91%E7%9A%84%E6%8B%BC%E5%9B%A2%E9%A1%B5%E9%9D%A2-%E6%B4%BB%E5%8A%A8%E8%BF%9B%E5%BA%A6.png)*我的拼团页面-活动进度*

##### 2.2.6.2 我的朋友
* 我的朋友列表中的名单为扫描我分享的海报中二维码参加活动并成功支付的用户信息，顶部显示我的朋友总数量，列表包含：微信头像、微信昵称和参加活动时间。
* 用户信息为微信授权后可以获取的微信头像和昵称，参加活动时间为支付所在的日期。
* 当前页面布局，默认显示数量为N个，如需查看其他用户，页面向上滑动加载其他名单信息。

![我的拼团页面-我的朋友](https://raw.githubusercontent.com/systemcc/group-buying/master/IMG/%E6%88%91%E7%9A%84%E6%8B%BC%E5%9B%A2%E9%A1%B5%E9%9D%A2-%E6%88%91%E7%9A%84%E6%9C%8B%E5%8F%8B.png)*我的拼团页面-我的朋友*

#### 2.2.7 我的分享海报
* 二维码继承我的渠道编码，同时记录分享人的OpenID，成为扫码人的父节点；
* A为团长分享海报，如未成团时B参加A团后分享海报，C扫码B的海报时，如A团未成团，C参加的为A团；如A团已成团，C需另开团购买；

#### 2.2.8 参团人-购买页面
* 参团人扫描他人分享的海报二维码参加活动，同样需要授权，授权通过后进入购买页面。
* 页面同发起人购买页面，仅开团购买按钮变为“参团购买”，后续支付流程一致，支付成功后点击“完成”，页面跳转至“我的参团页面”（同发起人的拼团页面）。

![参团人-购买页面](https://raw.githubusercontent.com/systemcc/group-buying/master/IMG/%E5%8F%82%E5%9B%A2%E4%BA%BA-%E8%B4%AD%E4%B9%B0%E9%A1%B5%E9%9D%A2.png)*参团人-购买页面*

#### 2.2.9 参团人-参团页面
* 同2.2.6我的拼团页面，记录我的朋友为当前用户的转介绍朋友。

#### 2.2.10 参团人-团已满
* 当参团人扫描二维码参加活动，由于当前团已满，进入购买页面前弹出层提示“团已满，会为您重新开团（如下图），点击该弹出层的“确定”按钮，当前购买页面，满团的弹出层关闭后直接弹出层显示微信支付，进行支付（系统自动另开团处理）。
* 支付后流程相同。

![参团人-团已满](https://raw.githubusercontent.com/systemcc/group-buying/master/IMG/%E5%8F%82%E5%9B%A2%E4%BA%BA-%E5%9B%A2%E5%B7%B2%E6%BB%A1.png)*参团人-团已满*

## 3 微信服务号
* 服务号中包含：系统通知和我的订单。

![微信服务号](https://raw.githubusercontent.com/systemcc/group-buying/master/IMG/%E6%9C%8D%E5%8A%A1%E5%8F%B7-%E7%B3%BB%E7%BB%9F%E9%80%9A%E7%9F%A5.png)*微信服务号*

### 3.1 系统通知
* 微信自身的通知接口，在拼团过程中为团长和参团人提供消息提醒。
* 团长：</br>

|通知标题|说明|内容|详情|
|-------|----|----|----|
|开团成功通知|团长开团并支付后|恭喜您开团成功，点击查看详情；课程名称，开团时间|点击详情，打开我的拼团页面|
|拼团进度通知|有新成员参团时|用户+微信昵称参团成功，邀请1或者2名成员即可成团|点击详情，打开我的拼团页面|
|拼团活动倒计时|距离活动结束时间24小时时，如尚未成团，对团长发送通知|距离活动截止日期仅24小时，尚未成团|点击详情，打开我的拼团页面|
|拼团成功通知|拼团达到3人|恭喜您与成员1昵称、成员2昵称拼团成功，XX时间内工作人员会与您取得联系，安排上课事宜。|点击详情，打开我的拼团页面|
|拼团结果通知|活动结束后拼团尚未成功|您所发起或参与的团购拼团未成功，金沃斯客服人员会在48小时（or 24小时）联系您后续事宜|点击详情，打开我的拼团页面|

* 参团人：

|通知标题|说明|内容|详情|
|-------|----|----|----|
|参团成功通知|参团并成功支付|恭喜您惨团成功，点击查看详情；课程名称，参团时间|点击详情，打开我的参团页面|
|拼团成功通知|拼团达到3人|恭喜您与成员1昵称、成员2昵称拼团成功，XX时间内工作人员会与您取得联系，安排上课事宜。|点击详情，打开我的参团页面|
|拼团结果通知|活动结束后拼团尚未成功|您所发起或参与的团购拼团未成功，金沃斯客服人员会在48小时（or 24小时）联系您后续事宜|点击详情，打开我的参团页面|

### 3.2 我的订单
* 服务号增加菜单“我的订单”，如3微信服务号中的图片。
* 点击菜单“我的订单”，进入订单列表页面，如下图：

#### 3.2.1 我的订单列表
* 列表显示我的订单，分为全部和待支付标签，默认显示“全部”标签的内容，全部：显示所有订单，待支付：显示状态为待支付的订单；
* 订单列表包含字段：订单号、订单状态、课程名称、数量（均为×1）、订单时间、实付金额。
* 当前页面显示N个订单，如需查看其他订单，需向上滑动页面加载其他订单信息。
* 订单状态、订单时间和操作：

|订单状态|说明|订单时间|操作|
|-------|----|-------|----|
|待支付|开/参团后尚未支付|显示订单提交时间|查看按钮：点击后查看订单详情，详见3.2.2订单详情；</br>待支付按钮：点击待支付，弹出层打开微信支付页面，支付成功后刷新列表页面改变订单状态和订单时间。|
|已支付|开/参团后成功支付|显示支付时间|查看按钮：点击后查看订单详情，详见3.2.2订单详情。|
|已取消|开/参团后48小时未支付，订单自动取消|订单取消的时间|查看按钮：点击后查看订单详情，详见3.2.2订单详情。|

![服务号-我的订单列表](https://raw.githubusercontent.com/systemcc/group-buying/master/IMG/%E6%9C%8D%E5%8A%A1%E5%8F%B7-%E6%88%91%E7%9A%84%E8%AE%A2%E5%8D%95%E5%88%97%E8%A1%A8.png)*服务号-我的订单列表*
